/*!
 * SCG-gd-pixim - v1.10.19-1
 * 
 * @require Pixim.js - v1.14.0
 * @require howler.js - v2.2.2
 * @license MIT
 */
this.SCG=function(t,e){"use strict";function n(t){console.warn("view modal",t.type);for(var e=t.texts.body,n=t.texts.button,o=function(t){var e=document.createElement("div");e.style.width="100%",e.style.height="100%",e.style.backgroundColor="rgba(0, 0, 0, 0.6)",e.style.textAlign="center",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.zIndex=t,e.style.display="table",e.style.userSelect="none";var n=e.appendChild(document.createElement("div"));n.style.display="table-cell",n.style.verticalAlign="middle";var o=n.appendChild(document.createElement("div"));o.style.borderRadius="10px",o.style.width="min(90%, 330px)",o.style.backgroundColor="#FFF",o.style.color="#000",o.style.display="inline-block",o.style.fontSize="14px",o.style.boxShadow="#000 2px 2px 5px";var r=o.appendChild(document.createElement("div"));return r.style.margin="20px 10px",r.style.lineHeight="30px",{top:e,container:o,box:r}}(t.zIndex),r=o.top,i=o.box,a=0;a<e.length;a++)i.appendChild(document.createTextNode(e[a])),i.appendChild(document.createElement("br"));var s=i.appendChild(document.createElement("div"));return s.style.backgroundColor="#E99",s.style.color="#FFF",s.style.fontWeight="bold",s.style.cursor="pointer",s.style.fontSize="24px",s.style.display="inline-block",s.style.width="60%",s.style.lineHeight="50px",s.style.marginTop="30px",s.style.borderRadius="10px",s.style.boxShadow="#000 2px 2px 2px",s.appendChild(document.createTextNode(n)),r.addEventListener("click",(function(){t.onFinish()})),r}var o=function(t){this._options=t};o.prototype.addModal=function(t){this._addModal({type:t.type,texts:t.texts,createHandler:t.createHandler||n,onFinish:t.onFinish})},o.prototype.addCustomModal=function(t){this._addModal(t)},o.prototype._addModal=function(t){var e={type:t.type,texts:t.texts,onFinish:function(e){n&&n.parentNode&&n.parentNode.removeChild(n),t.onFinish(e)},zIndex:(this._options.zIndex||0).toString()},n=t.createHandler(e);n&&(this._options.container||document.body).appendChild(n)};var r=function(t){void 0===t&&(t={}),this._filterCount=0;var e=t.zIndex,n=t.container,o=document.createElement("div");o.style.width="100%",o.style.height="100%",o.style.backgroundColor="rgba(0, 0, 0, 0)",o.style.textAlign="center",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.display="table",o.style.zIndex=(e||0).toString(),this._filter=o,this._container=n||document.body};r.prototype.view=function(t){this._filterCount++,this._filter.style.backgroundColor=t||"rgba(0, 0, 0, 0)",this._container.appendChild(this._filter)},r.prototype.hide=function(){this._filterCount--,this._filterCount<=0&&(this._filterCount=0,this._filter.parentNode&&this._filter.parentNode.removeChild(this._filter))};var i,a=function(t){var e={onFinish:function(){n&&n.element.parentNode&&n.element.parentNode.removeChild(n.element)},zIndex:(t.zIndex||0).toString()},n=t.createHandler?t.createHandler(e):function(t){var e=document.createElement("div");e.style.width="100%",e.style.height="100%",e.style.background="#000",e.style.textAlign="center",e.style.position="absolute",e.style.zIndex=t.zIndex,e.style.left=e.style.top="0";var n=e.appendChild(document.createElement("div"));n.style.width="min(90%, 330px)",n.style.height="100%",n.style.margin="auto";var o=n.appendChild(document.createElement("div"));o.style.width="100%",o.style.height="100%",o.style.display="table";var r=o.appendChild(document.createElement("div"));r.style.display="table-cell",r.style.verticalAlign="middle";var i=r.appendChild(document.createElement("div"));i.style.textAlign="right",i.style.color="#FFF";var a=i.appendChild(document.createTextNode("0%")),s=r.appendChild(document.createElement("div"));s.style.width="100%",s.style.height="10px",s.style.position="relative";var c=s.appendChild(document.createElement("div"));c.style.width="100%",c.style.height="100%",c.style.background="#FFF",c.style.position="absolute",c.style.top="0px";var p=s.appendChild(document.createElement("div"));return p.style.width="0%",p.style.height="100%",p.style.background="#EB6100",p.style.position="absolute",p.style.top="0px",{element:e,progress:function(e){var n=Math.floor(100*e);a.textContent=n+"%",p.style.width=n+"%",1===e&&setTimeout((function(){t.onFinish()}),500)}}}(e);n&&(t.container||document.body).appendChild(n.element),this._preloadViewData=n};a.prototype.progress=function(t){this._preloadViewData&&this._preloadViewData.progress(t)},function(t){var e,n=function(t){this.type=t.type,this.original=t.original||null,this.message=t.message||""};t.ErrorBase=n,(e=t.framework||(t.framework={})).Basic="error",e.ReInitialize="re-initialize",e.Uninitialized="uninitialized",e.Build="build-failed",e.ReBuild="re-build",e.DataGet="data-get-failed";var o,r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(n);t.FrameworkError=r,(o=t.api||(t.api={})).Basic="error",o.Uncallable="uncallable",o.Unauthorized="unauthorized",o.SendScore="send-score-failed",o.DataSet="data-set-failed",o.AdMissing="ad-missing",o.AdSkipped="ad-skipped",o.CycleTiming="cycle-timing",o.ContentLoad="content-load-failed",o.UndefinedLayer="layer-undefined",o.UsedContent="used-content",o.UnsupportedLanguage="unsupported-language",o.UnsupportedOperation="unsupported-operation";var i=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(n);t.ApiError=i}(i||(i={}));var s,c=i;!function(t){t.Error="error",t.BuildError="buildError",t.ApiError="apiError",t.RewardAdApiError="rewardAdApiError"}(s||(s={}));var p=s,u={};u[p.Error]={body:["エラーが発生しました","通信環境の良い場所で","再度お試しください"],button:"リトライ"},u[p.BuildError]={body:["ゲームの起動に失敗しました","ページの再読み込み、または","アプリの再起動をお試しください"],button:"OK"},u[p.ApiError]={body:["エラーが発生しました","通信環境の良い場所で","再度お試しください"],button:"リトライ"},u[p.RewardAdApiError]={body:["現在ご提供できる広告が無いか","広告をスキップされている可能性があるため","もう一度お試しいただくか","使用しないでゲームを続けてください"],button:"OK"};var l=function(){this._isInit=!1,this._isBuild=!1};l.prototype.init=function(t,e,n){if(this._isInit)throw new c.FrameworkError({type:c.framework.ReInitialize});this._isInit=!0,this._gameEngineOptions=t,this._coreOptions=e,this._extraOptions=n||{}},l.prototype._buildAsync=function(t,e){var n,i=this;return(n=this._extraOptions.languageOptions,n?"string"==typeof n?fetch(n).then((function(t){return t.json()})):Promise.resolve(n):Promise.resolve(null)).then((function(t){return t||{}})).then((function(t){return{languages:function(t){var e=[];if(t)if("string"==typeof t)e.push(t);else if(Array.isArray(t)){for(var n=0;n<t.length;n++)"string"==typeof t[n]&&e.push(t[n]);0===e.length&&e.push("ja")}else e.push("ja");else e.push("ja");return e}(i._extraOptions.languages),modalTexts:t.modalTexts||{}}})).then((function(n){if(!i._isInit)throw new c.FrameworkError({type:c.framework.Uninitialized});if(i._isBuild)throw new c.FrameworkError({type:c.framework.ReBuild});i._isBuild=!0;var s=new t({languages:n.languages},i._coreOptions),l=s.createReceiver(),d=Object.assign({},i._extraOptions.modalOptions||{});d.zIndex=void 0===d.zIndex?10:d.zIndex;var h=Object.assign({},i._extraOptions.filterOptions||{});h.zIndex=void 0===h.zIndex?9:h.zIndex;var y="boolean"==typeof i._extraOptions.preloadViewOptions?{}:Object.assign({},i._extraOptions.preloadViewOptions||{});y.zIndex=void 0===y.zIndex?1:y.zIndex;var f=new o({container:d.container,zIndex:d.zIndex}),_=new r(h);l.on("viewFilter",(function(t){_.view(t.data)})),l.on("hideFilter",(function(){_.hide()}));var m=function(t){_.view();return function(e){setTimeout((function(){_.hide(),t(e)}),500)}},v=function(t){var e=t.type,o=t.onFinish,r=s.getLanguage(),i=n.modalTexts[e]&&n.modalTexts[e][r]?n.modalTexts[e][r]:u[e]||u.error,a=m(o);f.addModal({type:e,texts:i,createHandler:d.createHandler,onFinish:a})},g=function(t){v(t.data)},w=function(t){var e,n,o,r,i,a;e=t.data,n=e.type,o=e.texts,r=e.createHandler,i=e.onFinish,a=m(i),f.addCustomModal({type:n,texts:o,createHandler:r,onFinish:a})};l.on("addModal",g),l.on("addCustomModal",w);var A=i._createGameEngine({core:s,languages:n.languages}),b=A.createReceiver();return b.on("addModal",g),b.on("addCustomModal",w),s.initializeAsync().then((function(){return s.loadDataAsync()})).then((function(t){return s.introAsync().then((function(){if(i._extraOptions.preloadViewOptions){var n=new a(y);b.on("preloadProgress",(function(t){n.progress(t.data)}))}return A.buildAsync(e,t)}))})).catch((function(t){throw i._isBuild=!1,i._destroyGameEngine(),d.skipBuildErrorModal||v({type:p.BuildError,onFinish:function(){}}),new c.FrameworkError({type:c.framework.Build,original:t})}))}))},l.prototype._destroyGameEngine=function(){};
/*!
     * @tawaship/transceiver - v1.0.0
     * 
     * @author tawaship (makazu.mori@gmail.com)
     * @license MIT
     */
/*!
     * @tawaship/emitter - v3.1.1
     * 
     * @author tawaship (makazu.mori@gmail.com)
     * @license MIT
     */
var d=function(){this._events={}};d.prototype._on=function(t,e,n){if(!t||!e)return this;for(var o=this._events[t]=this._events[t]||[],r=0;r<o.length;r++)if(o[r].callback===e)return this;return o.push({callback:e,once:n}),this},d.prototype.on=function(t,e){return this._on(t,e,!1)},d.prototype.once=function(t,e){return this._on(t,e,!0)},d.prototype.off=function(t,e){if(!t||!e)return this;for(var n=this._events[t]||[],o=0;o<n.length;o++)if(n[o].callback===e)return n.splice(o,1),this;return this},d.prototype._emit=function(t,e){for(var n=[],o=arguments.length-2;o-- >0;)n[o]=arguments[o+2];if(!t)return this;for(var r=this._events[t]||[],i=[],a=r.length-1;a>=0;a--){var s=r[a];s.once&&r.splice(a,1),i.push(s)}for(var c=i.length-1;c>=0;c--)i[c].callback.apply(e,n);return this},d.prototype.emit=function(t){for(var e,n=[],o=arguments.length-1;o-- >0;)n[o]=arguments[o+1];return(e=this)._emit.apply(e,[t,this].concat(n))},d.prototype.cemit=function(t,e){for(var n,o=[],r=arguments.length-2;r-- >0;)o[r]=arguments[r+2];return(n=this)._emit.apply(n,[t,e].concat(o))},d.prototype._emitAll=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];if(null==t)return this;var o=[];for(var r in this._events)for(var i=this._events[r]||[],a=i.length-1;a>=0;a--){var s=i[a];s.once&&i.splice(a,1),o.push(s)}for(var c=o.length-1;c>=0;c--)o[c].callback.apply(t,e);return this},d.prototype.emitAll=function(){for(var t,e=[],n=arguments.length;n--;)e[n]=arguments[n];return(t=this)._emitAll.apply(t,[this].concat(e))},d.prototype.cemitAll=function(t){for(var e,n=[],o=arguments.length-1;o-- >0;)n[o]=arguments[o+1];return(e=this)._emitAll.apply(e,[t].concat(n))},d.prototype.clear=function(t){return void 0===t&&(t=""),t?delete this._events[t]:this._events={},this};var h=function(t){function e(e){t.call(this),this._connectors=[],this._transceiver=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getConnectors=function(){return this._connectors.concat()},e.prototype.send=function(t,e){for(var n=this._connectors,o=0;o<n.length;o++)n[o].receive(t,{sender:this._transceiver,data:e})},e.prototype.receive=function(t,e){if(this._transceiver.enabled)return this.cemit(t,this._transceiver,e)},e.prototype.connect=function(t){if(t!==this)return-1===this._connectors.indexOf(t)&&this._connectors.push(t),this},e.prototype.disconnect=function(t){if(t!==this){var e=this._connectors.indexOf(t);return e>-1&&this._connectors.splice(e,1),this}},e.prototype.disconnectAll=function(){for(var t=this._connectors,e=t.length-1;e>=0;e--){var n=t[e];this.disconnect(n),n.disconnect(this)}return this},e}(d),y=function(){this.enabled=!0,this._connector=new h(this)};y.prototype.getConnector=function(){return this._connector},y.prototype.emit=function(t,e){if(this.enabled)return this._connector.send(t,e),this},y.prototype.on=function(t,e){return this._connector.on(t,e),this},y.prototype.once=function(t,e){return this._connector.once(t,e),this},y.prototype.off=function(t,e){return this._connector.off(t,e),this},y.prototype.clear=function(t){return void 0===t&&(t=""),this._connector.clear(t),this},y.prototype.connect=function(t){var e=t.getConnector();return this._connector.connect(e),e.connect(this._connector),this},y.prototype.disconnect=function(t){var e=t.getConnector();return this._connector.disconnect(e),e.disconnect(this._connector),this},y.prototype.disconnectAll=function(){return this._connector.disconnectAll(),this},y.create=function(t){for(var e=[],n=0;n<t;n++)e.push(new y);return y.connect(e),e},y.connect=function(t){for(var e=0;e<t.length;e++)for(var n=e+1;n<t.length;n++)t[e].connect(t[n])};var f=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.emit=function(e,n){return t.prototype.emit.call(this,e,n)},e}(y),_=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.on=function(e,n){return t.prototype.on.call(this,e,n)},e.prototype.once=function(e,n){return t.prototype.once.call(this,e,n)},e}(y),m=function(t,e){this._isBuild=!1,this._progress=0,this._progressData={start:0,end:0,count:1};var n=t.core,o=t.languages;this._options=e,this._core=n,this._languages=o,this._transmitter=new f,this._coreReceiver=n.createReceiver()};m.prototype.createReceiver=function(){var t=new _;return this._transmitter.connect(t),t},m.prototype._addModalAsync=function(t){var e=this;return new Promise((function(n,o){e._transmitter.emit("addModal",{type:t,onFinish:n})}))},m.prototype._setProgressData=function(t){var e=Math.min(1,Math.max(this._progressData.end,0)),n=Math.min(1,Math.max(e,t.end));this._progress=e,this._progressData={start:e,end:n,count:Math.max(1,t.count)},this._dispatchProgress()},m.prototype._forwardProgress=function(){var t=this._progressData;this._progress+=(t.end-t.start)/t.count,this._progress=Math.min(this._progress,t.end,1),this._dispatchProgress()},m.prototype._finishProgress=function(){this._progress=1,this._dispatchProgress()},m.prototype._dispatchProgress=function(){this._transmitter.emit("preloadProgress",this._progress),this._core.onProgress(this._progress)};var v=function(t){this._core=t},g=!1,w=!1,A=0;function b(){t.Howler&&t.Howler.mute(A>0||g)}var E=function(){},x={isMutedSound:{configurable:!0}};E.watchVisibility=function(){!w&&t.Howler&&(document.addEventListener("visibilitychange",(function(t){"visible"===document.visibilityState?E.forceMute(!1):E.forceMute(!0)})),w=!0)},E.forceMute=function(t){t?A++:--A<0&&(A=0),b()},E.mute=function(e){t.Howler&&(g=e,b())},E.stopAllSounds=function(){t.Howler&&t.Howler.stop()},x.isMutedSound.get=function(){return g},Object.defineProperties(E,x);var P=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.emit=function(e,n){return t.prototype.emit.call(this,e,n)},e}(y),S=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.on=function(e,n){return t.prototype.on.call(this,e,n)},e.prototype.once=function(e,n){return t.prototype.once.call(this,e,n)},e}(y),C=function(t){function e(e,n){t.call(this,e),this._transmitter=n,E.watchVisibility()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.sendScoreAsync=function(t,e){return void 0===e&&(e={}),E.stopAllSounds(),this._core.sendScoreAsync(t,e).catch((function(t){if(t instanceof c.ApiError)throw t;throw new c.ApiError({type:c.api.Basic,original:t})}))},e.prototype.viewAdAsync=function(t){return void 0===t&&(t={}),E.forceMute(!0),this._core.viewAdAsync(t).then((function(){E.forceMute(!1)})).catch((function(t){if(E.forceMute(!1),t instanceof c.ApiError)throw t;throw new c.ApiError({type:c.api.Basic,original:t})}))},e.prototype.viewRewardAdAsync=function(t){return void 0===t&&(t={}),E.forceMute(!0),this._core.viewRewardAdAsync(t).then((function(){E.forceMute(!1)})).catch((function(t){if(E.forceMute(!1),t instanceof c.ApiError)throw t;throw new c.ApiError({type:c.api.Basic,original:t})}))},e.prototype.setDataAsync=function(t,e,n,o){return void 0===n&&(n="always"),void 0===o&&(o={}),this._core.setDataAsync(t,e,n,o).catch((function(t){if(t instanceof c.ApiError)throw t;throw new c.ApiError({type:c.api.Basic,original:t})}))},e.prototype.setDataAllAsync=function(t,e){return void 0===e&&(e={}),this._core.setDataAllAsync(t,e).catch((function(t){if(t instanceof c.ApiError)throw t;throw new c.ApiError({type:c.api.Basic,original:t})}))},e.prototype.flushDataAsync=function(t){return void 0===t&&(t={}),console.warn('[SCG] "flushDataAsync" is called'),this._core.flushDataAsync(t).catch((function(t){if(t instanceof c.ApiError)throw t;throw new c.ApiError({type:c.api.Basic,original:t})}))},e.prototype.callAsync=function(t,e){return void 0===e&&(e={}),this._core.callAsync(t,e)},e.prototype.operateAsync=function(t,e){return void 0===e&&(e={}),this._core.operateAsync(t,e)},e.prototype.prepareContentAsync=function(t,e){var n=this;return void 0===e&&(e={}),new Promise((function(o,r){n._transmitter.emit("prepareContent",{Content:t.Content,onProgress:t.onProgress,isThrowError:e.isThrowError,onFinish:o,onError:r})})).catch((function(t){if(t instanceof c.ApiError)throw t;throw new c.ApiError({type:c.api.ContentLoad,original:t})}))},e.prototype.muteSound=function(t){E.mute(t)},e.prototype.stopAllSounds=function(){E.stopAllSounds()},e.prototype.isMutedSound=function(){return E.isMutedSound},e.prototype.getLanguage=function(){return this._core.getLanguage()},e.prototype.changeLanguageAsync=function(t,e){return void 0===e&&(e={}),this._core.changeLanguageAsync(t,e).catch((function(t){if(t instanceof c.ApiError)throw t;throw new c.ApiError({type:c.api.Basic,original:t})}))},e}(v),k=/iPhone/i,G=/iPod/i,D=/iPad/i,M=/\biOS-universal(?:.+)Mac\b/i,F=/\bAndroid(?:.+)Mobile\b/i,O=/Android/i,I=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,T=/Silk/i,z=/Windows Phone/i,j=/\bWindows(?:.+)ARM\b/i,R=/BlackBerry/i,H=/BB10/i,L=/Opera Mini/i,B=/\b(CriOS|Chrome)(?:.+)Mobile/i,N=/Mobile(?:.+)Firefox\b/i,V=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};var U,W=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var n=e.userAgent,o=n.split("[FBAN");void 0!==o[1]&&(n=o[0]),void 0!==(o=n.split("Twitter"))[1]&&(n=o[0]);var r=function(t){return function(e){return e.test(t)}}(n),i={apple:{phone:r(k)&&!r(z),ipod:r(G),tablet:!r(k)&&(r(D)||V(e))&&!r(z),universal:r(M),device:(r(k)||r(G)||r(D)||r(M)||V(e))&&!r(z)},amazon:{phone:r(I),tablet:!r(I)&&r(T),device:r(I)||r(T)},android:{phone:!r(z)&&r(I)||!r(z)&&r(F),tablet:!r(z)&&!r(I)&&!r(F)&&(r(T)||r(O)),device:!r(z)&&(r(I)||r(T)||r(F)||r(O))||r(/\bokhttp\b/i)},windows:{phone:r(z),tablet:r(j),device:r(z)||r(j)},other:{blackberry:r(R),blackberry10:r(H),opera:r(L),firefox:r(N),chrome:r(B),device:r(R)||r(H)||r(L)||r(N)||r(B)},any:!1,phone:!1,tablet:!1};return i.any=i.apple.device||i.android.device||i.windows.device||i.other.device,i.phone=i.apple.phone||i.android.phone||i.windows.phone,i.tablet=i.apple.tablet||i.android.tablet||i.windows.tablet,i}(navigator),Y=function(){};Y.isSPDevice=function(){return W.any},function(t){t.Standalone="Standalone",t.Yahoo="Yahoo",t.Gmo="Gmo",t.GmoSgtk="GmoSgtk",t.Simeji="Simeji",t.Au="Au",t.Gmode="Gmode",t.FBInstant="FBInstant",t.Lpm="Lpm",t._55bb="55bb",t.GameDistribution="GameDistribution",t.Fourm="Fourm",t.DeNA="DeNA",t.H5GP="H5GP",t.CrazyGames="CrazyGames",t.Glance="Glance"}(U||(U={}));var K,q=U;!function(t){t.StartGame="startGame",t.PlayGame="playGame",t.QuitGame="quitGame",t.FinishPlay="finishPlay"}(K||(K={}));var J,Q=K;!function(t){t.More="more",t.Less="less",t.Always="always"}(J||(J={}));var X=J,Z=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.buildAsync=function(t,n){var o=this,r=t.Content,i=t.width,a=t.height,s=t.addVarsAsync,u=t.definePlatformAssetsHandler,l=this._options.basepath||"./",d=this._options.version||"",h=this._options.xhr||!1,y=this._options.typeOptions,f=this._options.pixiOptions||{},_=this._options.addVarsAsync,m=i/a,v=this._options.canScroll||!1,g=t.layers||[];return this._setProgressData({end:.1,count:1}),this._core.startAsync(i,a).then((function(t){var w=t.adjuster,A=t.container||document.body,b=new e.Application(Object.assign(f,{width:i,height:a}),{container:A,autoAdjust:!!t.autoAdjust&&function(t){var e=w(m);t.fullScreen(e)}});b.view.style.position="relative",v&&(b.app.renderer.plugins.interaction.autoPreventDefault=!1,b.app.renderer.view.style.touchAction="auto");var x=void 0===d?"":"string"==typeof d||"number"==typeof d?d:"env"in d&&d.env||"",k={basepath:l,version:d,xhr:h,typeOptions:y},G=new r(k),D=new P,M=new S;D.connect(M);var F,O,I=new C(o._core,D),T=o._core.platform(),z={},j={api:I,data:n,env:{hasRewardAd:o._core.hasRewardAd(),isAdPlatform:o._core.isAdPlatform(),isSPDevice:Y.isSPDevice(),platform:T,unuseSynkLogo:o._core.unuseSynkLogo(),basepath:l,languages:o._languages,version:x},enum:{errors:c.api,platforms:q,callTypes:Q,registerTypes:X},additional:{},app:b,orders:z};F=o._core.createReceiver(),O=!1,F.on("pauseGame",(function(){O||(b.pause(!0),E.forceMute(!0),O=!0,z.onPauseGame&&z.onPauseGame())})),F.on("resumeGame",(function(){O&&(b.pause(!1),E.forceMute(!1),O=!1,z.onResumeGame&&z.onResumeGame())})),F.on("replayGame",(function(){z.onReplayGame&&z.onReplayGame()})),F.on("gotoNextLevel",(function(){z.onGotoNextLevel&&z.onGotoNextLevel()})),F.on("gotoHome",(function(){z.onGotoHome&&z.onGotoHome()})),F.on("gotoLevel",(function(t){z.onGotoLevel&&z.onGotoLevel(t.data)})),F.on("muteSound",(function(t){z.onMuteSound&&z.onMuteSound(t.data)})),F.on("endGame",(function(){z.onEndGame&&z.onEndGame()})),F.on("resize",(function(){var t=w(m);b.fullScreen(t)})),u&&u({platform:T,platforms:q});var R=G.assetCount+(t.prepareAsync?1:0)+(s?1:0)+(_?1:0);o._setProgressData({end:.8,count:R}),G.on(e.EVENT_LOADER_ASSET_LOADED,(function(){o._forwardProgress()}));var H=[];H.push(G.prepareAsync()),t.prepareAsync&&H.push(t.prepareAsync());var L={};s&&H.push(s({basepath:l,platform:T,platforms:q}).then((function(t){for(var e in o._forwardProgress(),t)L[e]=t[e]})));var B={};_&&H.push(_({basepath:l,platform:T,platforms:q}).then((function(t){for(var e in o._forwardProgress(),t)B[e]=t[e]})));var N=function(t,n,o,r,i,a){var s=function(t){var n=new t.Content(o);n.addVars(i());var r=t.onProgress;if(r){var a=n.assetCount,s=0;n.on(e.EVENT_LOADER_ASSET_LOADED,(function(){r(++s,a)}))}return n.prepareAsync().then((function(){return n}))};r=r||[],r.indexOf("main")>-1&&r.splice(r.indexOf("main"),1);for(var p=["main"].concat(r),u=0;u<p.length;u++)t.addLayer(p[u]);var l=function(e,n){return void 0===n&&(n="main"),-1===p.indexOf(n)?Promise.reject(new c.ApiError({type:c.api.UndefinedLayer})):t.attachAsync(e,n)};return n.on("prepareContent",(function(e){var n=function(){e.data,s(e.data).then((function(n){e.data.onFinish((function(e){return l(n,e).then((function(e){return{root:e,detach:function(){t.detach(n)}}}))}))})).catch((function(t){e.data.isThrowError?e.data.onError(t):a().then((function(){n()}))}))};n()})),l}(b,M,k,g,(function(){var t=Object.assign({},j);return t.data=o._core.getMemoryData(),t}),(function(){return o._addModalAsync(p.ApiError)}));return Promise.all(H).then((function(){for(var e in L)j.additional[e]=L[e];for(var n in B)j.additional[n]=B[n];return o._setProgressData({end:.9,count:1}),t.onPreloaded?t.onPreloaded():Promise.resolve()})).then((function(){G.addVars(j);var e=w(m);return b.fullScreen(e),o._setProgressData({end:1,count:1}),N(G,"main").then((function(e){return t.onPrepared?t.onPrepared():Promise.resolve()}))})).then((function(){return o._finishProgress(),b.play(),b}))}))},n}(m);var $=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._createGameEngine=function(t){return new Z(t,this._gameEngineOptions)},e}(l),tt=function(t){this._data=t||{}};tt.prototype.updateData=function(t){this._data=t},tt.prototype.get=function(t){if(t in this._data)return this._data[t]},tt.prototype.set=function(t,e,n){switch(void 0===n&&(n="always"),n){case"more":if(this.get(t)>=e)return;break;case"less":if(this.get(t)<=e)return;break;case"always":break;default:return}this._data[t]=e},tt.prototype.json=function(){return JSON.stringify(this._data)},tt.prototype.copy=function(){return JSON.parse(JSON.stringify(this._data))};var et="___SYSTEM___",nt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.emit=function(e,n){return t.prototype.emit.call(this,e,n)},e}(y),ot=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.on=function(e,n){return t.prototype.on.call(this,e,n)},e.prototype.once=function(e,n){return t.prototype.once.call(this,e,n)},e}(y),rt=function(t,e){this._autoFlushWithSendScore=!0,this._isGameStarted=!1,this._playCycle="wait",this._isInitialize=!1;var n=t.languages;this._options=e,this._languages=n,this._transmitter=new nt,this._dataManager=new tt};rt.prototype.createReceiver=function(){var t=new ot;return this._transmitter.connect(t),t},rt.prototype._viewFilter=function(){this._transmitter.emit("hideFilter")},rt.prototype._hideFilter=function(){this._transmitter.emit("hideFilter")},rt.prototype._addModalAsync=function(t,e,n){var o=this;return void 0===n&&(n=!1),n?Promise.reject(e):new Promise((function(e){o._transmitter.emit("addModal",{type:t,onFinish:e})}))},rt.prototype._addCustomModalAsync=function(t,e,n){var o=this;return new Promise((function(r){o._transmitter.emit("addCustomModal",{type:t,texts:e,createHandler:n,onFinish:r})}))},rt.prototype.initializeAsync=function(){var t=this;return this._initializeAsync().then((function(){t._isInitialize=!0}))},rt.prototype.loadDataAsync=function(){return this._isInitialize?this._loadDataAsync():Promise.reject()},rt.prototype.getMemoryData=function(){return this._dataManager.copy()},rt.prototype.introAsync=function(){return this._introAsync()},rt.prototype.startAsync=function(t,e){return this._isInitialize?this._startAsync(t,e):Promise.reject()},rt.prototype.sendScoreAsync=function(t,e){var n=this;if(!this._isInitialize)return Promise.reject();var o=e.isThrowError;return"playing"!==this._playCycle?Promise.reject(new c.ApiError({type:c.api.CycleTiming,message:'You must call the call API "playGame" in advance.'})):(this._viewFilter(),(this._autoFlushWithSendScore?this._processFlushDataAsync(!0,e):Promise.resolve()).then((function(){var r=function(){return n._sendScoreAsync(t,e).catch((function(t){return n._addModalAsync(p.ApiError,t,o).then(r)}))};return r()})).then((function(){n._playCycle="sended",n._hideFilter()})).catch((function(t){throw n._hideFilter(),t})))},rt.prototype.viewAdAsync=function(t){var e=this;return this._isInitialize?(this._viewFilter(),this._viewAdAsync(t).then((function(){e._hideFilter()})).catch((function(t){throw e._hideFilter(),t}))):Promise.reject()},rt.prototype.viewRewardAdAsync=function(t){var e=this;return this._isInitialize?(this._viewFilter(),this._viewRewardAdAsync(t).then((function(){e._hideFilter()})).catch((function(t){return e._hideFilter(),e._addModalAsync(p.RewardAdApiError,t).then((function(){throw t}))}))):Promise.reject()},rt.prototype.setDataAsync=function(t,e,n,o){var r=this;if(!this._isInitialize)return Promise.reject();var i=o.isThrowError,a=function(){return r._setDataAsync(t,e,n,o).catch((function(t){return r._addModalAsync(p.ApiError,t,i).then((function(){return a()}))}))};return a()},rt.prototype.setDataAllAsync=function(t,e){var n=this;return this._isInitialize?Promise.resolve().then((function(){for(var o=[],r=0;r<t.length;r++){var i=t[r];o.push(n.setDataAsync(i.key,i.value,i.registerType||"always",e))}return Promise.all(o)})).then((function(){})):Promise.reject()},rt.prototype._setDataAsync=function(t,e,n,o){return this._dataManager.set(t,e,n),Promise.resolve()},rt.prototype.flushDataAsync=function(t){return this._processFlushDataAsync(!1,t)},rt.prototype._processFlushDataAsync=function(t,e){var n=this;if(!this._isInitialize)return Promise.reject();var o=e.isThrowError,r=function(){return n._flushDataAsync(t,e).catch((function(t){return n._addModalAsync(p.ApiError,t,o).then((function(){return r()}))}))};return r().then((function(){n._transmitter.emit("dataFlushed",n._dataManager.copy())}))},rt.prototype.callAsync=function(t,e){var n=this;if(!this._isInitialize)return Promise.reject();var o=e.isThrowError,r=function(){return n._callAsync(t,e).catch((function(t){return n._addModalAsync(p.ApiError,t,o).then((function(){return r()}))}))};return r().then((function(){if(it[t])return it[t].call(n,e)}))},rt.prototype._callAsync=function(t,e){return Promise.resolve()},rt.prototype.getLanguage=function(){var t=this._getSystemData().language,e=this._languages;return t&&e.indexOf(t)>-1?t:e[0]},rt.prototype.changeLanguageAsync=function(t,e){var n=this;if(!this._isInitialize)return Promise.reject();if(-1===this._languages.indexOf(t))return Promise.reject(new c.ApiError({type:c.api.UnsupportedLanguage,original:null,message:t}));var o=this._getSystemData();return o.language=t,this._setSystemDataAsync(o,e).then((function(){return n._processFlushDataAsync(!1,e)}))},rt.prototype._getSystemData=function(){return this._dataManager.get(et)||{}},rt.prototype._setSystemDataAsync=function(t,e){return this.setDataAsync(et,t,"always",e)},rt.prototype.operateAsync=function(t,e){return Promise.reject(new c.ApiError({type:c.api.UnsupportedOperation,original:null,message:t.type}))},rt.prototype.onProgress=function(t){};var it={startGame:function(){if(this._isGameStarted)throw new c.ApiError({type:c.api.CycleTiming,message:'The call API "startGame" must not be executed multiple times.'});return this._isGameStarted=!0,this._options.startGameHook?this._options.startGameHook():Promise.resolve()},playGame:function(){if(!this._isGameStarted)throw new c.ApiError({type:c.api.CycleTiming,message:'You must execute the call API "startGame" in advance.'});if("wait"!==this._playCycle)throw new c.ApiError({type:c.api.CycleTiming,message:'You must execute the call API "quitGame" or "finishPlay" in advance.'});return this._playCycle="playing",this._options.playGameHook?this._options.playGameHook():Promise.resolve()},quitGame:function(){if(!this._isGameStarted)throw new c.ApiError({type:c.api.CycleTiming,message:'You must execute the call API "startGame" in advance.'});if("playing"!==this._playCycle)throw new c.ApiError({type:c.api.CycleTiming,message:'You must execute the call API "playGame" in advance.'});return this._playCycle="wait",this._options.quitGameHook?this._options.quitGameHook():Promise.resolve()},finishPlay:function(){if(!this._isGameStarted)throw new c.ApiError({type:c.api.CycleTiming,message:'You must execute the call API "startGame" in advance.'});if("sended"!==this._playCycle)throw new c.ApiError({type:c.api.CycleTiming,message:"You must execute the send score API in advance."});return this._playCycle="wait",this._options.finishPlayHook?this._options.finishPlayHook():Promise.resolve()}};function at(){try{return!!window.localStorage}catch(t){return!1}}var st=function(t){this._key=t};st.prototype.get=function(){if(!at())return console.warn('[SCG]: "localStorage" is unsupported.'),{};try{var t=window.localStorage.getItem(this._key);return t?JSON.parse(t):{}}catch(t){return{}}},st.prototype.set=function(t){if(at())try{window.localStorage.setItem(this._key,JSON.stringify(t))}catch(t){return}else console.warn('[SCG]: "localStorage" is unsupported.')};var ct=window;function pt(t){var e=document.createElement("div");e.style.width="100%",e.style.height="100%",e.style.backgroundColor="#FFF",e.style.textAlign="center",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.display="table",e.style.zIndex="5",e.style.userSelect="none";var n=e.appendChild(document.createElement("div"));n.style.display="table-cell",n.style.verticalAlign="middle";var o=n.appendChild(document.createElement("div"));o.style.width="min(90%, 330px)",o.style.display="inline-block",o.style.fontSize="14px";var r=o.appendChild(document.createElement("div"));if(r.style.margin="20px 10px",r.style.lineHeight="30px",t.icon){var i=r.appendChild(document.createElement("img"));i.src=t.icon,i.style.borderRadius="20%",r.appendChild(document.createElement("br"))}var a=r.appendChild(document.createElement("div"));return a.style.backgroundColor="#E99",a.style.color="#FFF",a.style.fontWeight="bold",a.style.cursor="pointer",a.style.fontSize="24px",a.style.display="inline-block",a.style.width="60%",a.style.lineHeight="50px",a.style.marginTop="30px",a.style.borderRadius="10px",a.style.boxShadow="#000 2px 2px 2px",a.appendChild(document.createTextNode(t.buttonText)),a.addEventListener("click",(function(){t.onFinish()})),e}var ut,lt=function(t){function e(e,n){if(t.call(this,e,n),this._adCallback=null,this._adResolver=null,this._adError=null,!n.gameId)throw new Error('[SCG-GameDistribution] Missing option "gameId"');if(!n.sdk)throw new Error('[SCG-GameDistribution] Missing option "sdk"');if(!n.contentKey)throw new Error('[SCG-GameDistribution] Missing option "contentKey"');n.introOptions=n.introOptions||{},this._storage=new st("snkgd-"+n.contentKey)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._initializeAsync=function(){var t=this;return new Promise((function(e,n){var o,r,i,a,s;ct.GD_OPTIONS={gameId:t._options.gameId,prefix:"snk__",onEvent:function(o){switch(o.name){case"SDK_READY":return"undefined"!==ct.gdsdk&&ct.gdsdk.preloadAd,void e();case"SDK_ERROR":return void n(o);case"SDK_GAME_START":var r=t._adCallback;return t._adCallback=t._adResolver=t._adError=null,void(r&&r());case"SDK_REWARDED_WATCH_COMPLETE":return void(t._adCallback=t._adResolver);case"AD_ERROR":return void(t._adError=o)}}},t._options.enablePinchIn||(ct.addEventListener("touchmove",(function(t){t.touches.length>1&&t.preventDefault()}),{passive:!1}),document.getElementsByTagName("html")[0].style.touchAction="manipulation"),o=document,r="script",i="gamedistribution-jssdk",s=o.getElementsByTagName(r)[0],o.getElementById(i)||((a=o.createElement(r)).id=i,a.src=t._options.sdk,s.parentNode&&s.parentNode.insertBefore(a,s))}))},e.prototype._introAsync=function(){var t=this;return this._options.usePrerollAd?new Promise((function(e){var n=t.getLanguage(),o=t._options.introOptions,r=o&&o.buttonTexts&&o.buttonTexts[n]?o.buttonTexts[n]:"PLAY",i=(o&&o.createHandler?o.createHandler:pt)({onFinish:function(){e(i)},buttonText:r,icon:o&&o.icon||void 0});(o&&o.container||document.body).appendChild(i)})).then((function(e){return t.viewAdAsync({}).catch((function(t){return t})).then((function(){e.parentNode&&e.parentNode.removeChild(e)}))})):Promise.resolve()},e.prototype._startAsync=function(t,e){return Promise.resolve({adjuster:function(t){var e=ct.innerWidth/ct.innerHeight<t,n=e?ct.innerWidth:ct.innerHeight*t,o=e?ct.innerWidth/t:ct.innerHeight;return{x:(ct.innerWidth-n)/2,y:(ct.innerHeight-o)/2,width:n,height:o}},autoAdjust:!0})},e.prototype._showAd=function(t,e,n){var o=this;if("undefined"!==ct.gdsdk&&"undefined"!==ct.gdsdk.showAd)return this._transmitter.emit("viewFilter","rgba(0, 0, 0, 0.6)"),void("rewarded"===t?(this._adCallback=function(){o._transmitter.emit("hideFilter"),n&&n(new c.ApiError({type:c.api.AdSkipped,original:o._adError}))},this._adResolver=function(){o._transmitter.emit("hideFilter"),e()},ct.gdsdk.showAd("rewarded")):(this._adCallback=function(){o._transmitter.emit("hideFilter"),e()},ct.gdsdk.showAd()));n?n(new c.ApiError({type:c.api.AdMissing})):e()},e.prototype._loadDataAsync=function(){return this._dataManager.updateData(this._storage.get()),Promise.resolve(this._dataManager.copy())},e.prototype._sendScoreAsync=function(t,e){var n=this;return e.skipSubsequent?Promise.resolve():new Promise((function(t,e){n._showAd("",t,e)})).catch((function(t){return t}))},e.prototype._viewAdAsync=function(){var t=this;return new Promise((function(e,n){t._showAd("",e,n)})).catch((function(t){throw new c.ApiError({type:c.api.AdSkipped,original:t})}))},e.prototype._viewRewardAdAsync=function(){var t=this;return new Promise((function(e,n){t._showAd("rewarded",e,n)})).then((function(){console.warn("OK")})).catch((function(t){throw console.warn(t),new c.ApiError({type:c.api.AdSkipped,original:t})}))},e.prototype.hasRewardAd=function(){return!0},e.prototype.isAdPlatform=function(){return!0},e.prototype.platform=function(){return q.GameDistribution},e.prototype.unuseSynkLogo=function(){return!0},e.prototype._flushDataAsync=function(){return this._storage.set(this._dataManager.copy()),Promise.resolve()},e}(rt);!function(t){t.score="score",t.level="level"}(ut||(ut={}));var dt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.startAsync=function(t){return this._buildAsync(lt,t)},e}($);return new dt}({Howl:"undefined"==typeof Howl?null:Howl,Howler:"undefined"==typeof Howler?null:Howler},Pixim);
